@using FirstMVC5App.Component
@using FirstMVC5App.Component.Helpers
@using FirstMVC5App.Model.Models
@*@model FirstMVC5App.Component.PaginatorModel<APP_BOOK>*@
@model FirstMVC5App.Component.PaginatorModelSort<APP_BOOK>
@{
    ViewBag.Title = "Книги";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section scripts{}

@* Информация про модальные окна на Bootstrap *@
@* http://metanit.com/sharp/mvc5/14.6.php *@
@* http://bootstrap-3.ru/javascript.php#modals *@

<div id="modDialog" class="modal fade" role="dialog">
    <div id="dialogContent" class="modal-dialog"></div>
</div>

<h2>@ViewBag.Title</h2>

<p class="btn_add">
    @Html.ActionLink(" ",
        "Create",
        null,
        new
        {
            @class = "tool_type_book btn glyphicon glyphicon-plus-sign",
            data_toggle = "tooltip",
            data_placement = "top",
            title = "Добавить новую книгу"
        })
</p>

@Html.DisplayPaginatorLinks("Book", new { currentNumberPage = Model.Paginator.CurrentNumberPage }, Model.Paginator)

<table class="table table-striped table-hover ">
    <tr>
        <th></th>
        @*@Html.DisplayHeaderSort(Model.Element)*@
        @*todo: поменять на System.Linq.Expressions.Expression<func<TModel, TProperty>> expression*@

        <th>
            @Html.ActionLink(@Html.DisplayNameFor(model => model.Element.NAME).ToHtmlString(), "Index", new { sName = Model.Sortable.sName.Revers(), sGanre = Model.Sortable.sGanre, sPrice = Model.Sortable.sPrice, page = Model.Paginator.CurrentNumberPage })
            
        </th>
        <th>
            @Html.ActionLink(@Html.DisplayNameFor(model => model.Element.GANRE).ToHtmlString(), "Index", new { sName = Model.Sortable.sName, sGanre = Model.Sortable.sGanre.Revers(), sPrice = Model.Sortable.sPrice, page = Model.Paginator.CurrentNumberPage })
        </th>
        <th>
            @Html.ActionLink(@Html.DisplayNameFor(model => model.Element.PRICE).ToHtmlString(), "Index", new { sName = Model.Sortable.sName, sGanre = Model.Sortable.sGanre, sPrice = Model.Sortable.sPrice.Revers(), page = Model.Paginator.CurrentNumberPage })
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model.Items)
    {
        <tr>
            <td class="clickable-row" data-href='@Url.Action("Details", "Book", new {id = item.ID})'>
                @Html.DisplayImage(new {src = item.IMG_FILE_PATH, @class = "img-thumbnail img-responsive center-block", alt = "Responsive image"})
            </td>
            <td class="clickable-row" data-href='@Url.Action("Details", "Book", new {id = item.ID})'>
                @Html.DisplayFor(modelItem => item.NAME)
            </td>
            <td class="clickable-row" data-href='@Url.Action("Details", "Book", new {id = item.ID})'>
                @Html.DisplayFor(modelItem => item.GANRE)
            </td>
            <td class="clickable-row" data-href='@Url.Action("Details", "Book", new {id = item.ID})'>
                @Html.DisplayFor(modelItem => item.PRICE)
            </td>
            <td>
                @Html.ActionLink(" ",
                    "Edit",
                    new {id = item.ID},
                    new
                    {
                        @class = "tool_type_book book_edit glyphicon glyphicon-pencil",
                        data_toggle = "tooltip",
                        data_placement = "top",
                        title = String.Format("Редактировать книгу \"{0}\"", item.NAME)
                    }) |
                @Html.ActionLink(" ",
                    "DetailsPartial",
                    new {id = item.ID},
                    new
                    {
                        @class = "tool_type_book book_details glyphicon glyphicon-file",
                        data_toggle = "tooltip",
                        data_placement = "top",
                        title = String.Format("Быстрый просмотр книги \"{0}\"", item.NAME)
                    }) |
                @Html.ActionLink(" ",
                    "Delete",
                    new {id = item.ID},
                    new
                    {
                        @class = "tool_type_book book_delete glyphicon glyphicon-trash",
                        data_toggle = "tooltip",
                        data_placement = "top",
                        title = String.Format("Удалить книгу книгу \"{0}\"", item.NAME)
                    })
            </td>
        </tr>
    }

</table>

<div class="text-center">
    @Html.DisplayPaginatorLinks("Book", Model.Sortable, Model.Paginator)
</div>
    
